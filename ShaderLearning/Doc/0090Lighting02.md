# Unity 的渲染路径

## 顶点照明渲染路径

顶点照明渲染路径是对硬件配置要求最少 , 运算性能最高 , 但同时也是得到的效果最差的一种类型 . 它不支持那些逐像素才能得到的效果 , 例如阴影 , 法线映射 , 高精度的高光反射等 . 实际上 , 它仅仅是前向渲染路径的一个子集 . 也就是说 , 所有可以在顶点照明渲染路径中实现的功能都可以在前向渲染路径中完成 . 就如它的名字一样 , 顶点照明渲染路径只是使用了逐顶点的方式来计算光照 .

实际上 , 我们在前向渲染路径中也可以计算一些逐顶点的光源 . 但如果选择使用顶点照明渲染路径 , 那么 Unity 会只填充那些逐顶点相关的光源变量 , 意味着我们不可以使用一些逐像素光照变量 .

### Unity 中的顶点照明渲染

顶点照明渲染路径通常在一个 Pass 中就可以完成对物体的渲染 . 在这个 Pass 中 , 我们会计算我们关心的所有光源对该物体的照明 , 并且这个计算是按逐顶点处理的 . 这是 Unity 中最快速的渲染路径 , 并且具有最广泛的硬件支持 ( 但是游戏机上并不支持这种路径 ) .

### 可访问的内置变量和函数

在 Unity 中 , 我们可以在一个顶点照明的 Pass 中最多访问到 8 个逐顶点光源 . 如果我们只需要渲染其中两个光源对物体的照明 , 可以仅使用下表中内置光照数据的前两个 . 如果影响到该物体的光源数目小于 8 , 那么数组中剩下的光源颜色会设置成黑色 .

| 名称                | 类型      | 描述                                                                                                                                                                                            |
| ------------------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| unity_LightColor    | half4[8]  | 光源颜色                                                                                                                                                                                        |
| unity_LightPosition | float4[8] | xyz 分量是视角空间中的光源位置 . 如果光源是平行光 , 那么 z 分量值为 0 , 其他光源类型 z 分量为 1                                                                                                 |
| unity_LightAtten    | half4[8]  | 光源衰减因子 . 如果光源是聚光灯 , x 分量是 cos(spotAngle/2) , y 分量是 1/cos(spotAngle/4); 如果是其他类型的光源 , x分量是 -1 , y 分量是 1 . z 分量是衰减的平方 , w 分量是光源范围开根号的结果 . |